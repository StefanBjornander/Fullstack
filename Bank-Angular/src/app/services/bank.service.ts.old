import { Injectable } from '@angular/core';
import { Observable } from 'rxjs/Observable';
import { HttpClient } from '@angular/common/http';
import { Customer } from '../model/customer';
import { Account } from '../model/account';
import { History } from '../model/history';

@Injectable()
export class BankService {
  constructor(private http: HttpClient) {}
    
/*  private internalCustomerArray;
  private internalAccountArray;
  private internalHistoryArray;

    this.internalCustomerArray = [[1, "Adam Bertilsson"], [2, "Bertil Ceasarsson"],
                                  [3, "Ceasar Davidsson"], [4, "David Eriksson"],
                                  [5, "Erik Filipsson"]];

    this.internalAccountArray = [[1, 1], [2, 1], [3, 1],
                                 [4, 2], [5, 2], [6, 2],
                                 [7, 3], [8, 3], [9, 3],
                                 [10, 4], [11, 3], [12, 4],
                                 [13, 5], [14, 5], [15, 5]];

    this.internalHistoryArray = [[1, Date.now(), 100], [2, Date.now(), 100], [3, Date.now(), 100], 
                                 [4, Date.now(), 100], [5, Date.now(), 100], [6, Date.now(), 100], 
                                 [7, Date.now(), 100], [7, Date.now(), 100], [8, Date.now(), 100], 
                                 [10, Date.now(), 100], [11, Date.now(), 100], [12, Date.now(), 100], 
                                 [13, Date.now(), 100], [14, Date.now(), 100], [15, Date.now(), 100]];
  }*/

  getCustomerArray(): Observable<Customer[]> { // 
    var x = this.http.get<Customer[]>('http://localhost:3000/api/customers');
    //var x = this.http.get<Customer[]>('api/customers');
    alert(JSON.stringify(x));
    return x;
  }

  getCustomerArrayX() {
    var customerArray = [];
    var internalAccountArray = this.internalAccountArray;

    this.internalCustomerArray.forEach(function (arr) {
      var customerNumber = arr[0];
      var customerName = arr[1];
      var accountArray = [];
    
      internalAccountArray.forEach(function (a) {
        var accountNumber = a[0];
        var accountCustomerNumber = a[1];

        if (customerNumber == accountCustomerNumber) {
          var account = new Account(accountNumber, customerNumber);
          accountArray.push(account);
        }
      });

      var customer = new Customer(customerNumber, customerName, accountArray);
      customerArray.push(customer);
    });

    return customerArray;
  }

  addCustomer(customerName) {
    this.internalCustomerArray.push([0, customerName]);
    return 123;
  }

  editCustomer(customerNumber, newCustomerName) {
    this.internalCustomerArray.push([0, newCustomerName]);
  }

  deleteCustomer(customerNumber) {
    return null;
  }

  addAccount(customerNumber) {
    return 456;
  }

  deposit(accountNumber, amount) {
  }

  withdraw(accountNumber, amount) {
  }

  getHistory(accountNumber) {
    return [];
  }

  deleteAccount(accountNumber) {
    return null;
  }
}
